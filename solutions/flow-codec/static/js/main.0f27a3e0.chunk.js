(this["webpackJsonpflow-codec"]=this["webpackJsonpflow-codec"]||[]).push([[0],{15:function(e,t,n){e.exports=n(27)},20:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),i=n(8),c=n.n(i),u=n(7),l=(n(20),n(3)),s=n(6),d=n(1),p=n(2),f=n(5),h=n(4),m=function(e){var t=e.label,n=e.value,a=e.onChange;return r.a.createElement("label",{className:"NodeConfigProp"},t,r.a.createElement("input",{type:"checkbox",checked:n,onChange:function(e){a(e.target.checked)}}))},v=function(e){var t=e.label,n=e.value,a=e.options,o=e.onChange,i=function(e){o(e.target.value)};return r.a.createElement("div",{className:"NodeConfigProp"},t,a.map((function(e){return r.a.createElement("label",{key:e},r.a.createElement("input",{name:t,value:e,checked:n===e,onChange:i,type:"radio"}),e)})))};function g(e){var t=e.node,n=e.refresh,i=t.config,c=i.isLoop,u=i.ende,l=Object(o.useCallback)((function(e){t.handleChange.call(t,e),n()}),[t.handleChange]);return r.a.createElement("div",{className:"JsonCodec"},r.a.createElement(v,{label:"\u7f16\u89e3\u7801",value:u,options:["decode","encode"],onChange:l}),u===a.Decode&&r.a.createElement(m,{label:"\u5faa\u73af\u89e3\u7801",value:c,onChange:l}))}!function(e){e.Decode="decode",e.Encode="encode"}(a||(a={}));var b,C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.JsonCodec;Object(d.a)(this,e),this.id=void 0,this.type=void 0,this.input=void 0,this.output=void 0,this.config=void 0,this.ConfigUi=void 0,this.id=t,this.type=n,this.input="",this.output="",this.config={},this.ConfigUi=g}return Object(p.a)(e,[{key:"run",value:function(e){return""}},{key:"handleChange",value:function(e){}}]),e}();function O(e){var t=e.node,n=e.refresh,a=t.config,i=a.isLoop,c=a.ende,u=Object(o.useCallback)((function(e){t.handleChange.call(t,e),n()}),[t.handleChange]);return r.a.createElement("div",{className:"JsonCodec NodeState"},r.a.createElement(v,{label:"\u7f16\u89e3\u7801",value:c,options:["JSON.parse","JSON.stringify","\u683c\u5f0f\u5316"],onChange:u}),r.a.createElement(m,{label:"\u7f16\u89e3\u7801",value:i,onChange:u}))}!function(e){e.Decode="JSON.parse",e.Encode="JSON.stringify",e.Format="\u683c\u5f0f\u5316"}(b||(b={}));var E,y=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e,E.JsonCodec)).output="",a.input="",a.config={isLoop:!1,ende:b.Decode},a.ConfigUi=O,a}return Object(p.a)(n,[{key:"render",value:function(){var e=this.config,t=(e.isLoop,e.ende);return r.a.createElement("div",{className:"JsonCodec NodeState"},r.a.createElement(v,{label:"\u7f16\u89e3\u7801",value:t,options:["JSON.parse","JSON.stringify","\u683c\u5f0f\u5316"],onChange:this.handleChange}))}},{key:"run",value:function(e){if(!e)return"";this.input=e;var t="";this.config.ende===b.Decode?t=JSON.parse(e):t=this.config.ende===b.Format?JSON.stringify(e,null,2):JSON.stringify(e);return this.output=t,t}},{key:"handleChange",value:function(e){var t={};"boolean"===typeof e&&(t.isLoop=e),"string"===typeof e&&(t.ende=e),this.config=Object(l.a)(Object(l.a)({},this.config),t)}}]),n}(C),N=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e,E.Input)).output="",a.input="",a.config={},a.ConfigUi=function(){return r.a.createElement(r.a.Fragment,null)},a}return Object(p.a)(n,[{key:"run",value:function(){return this.output=this.input,this.output}},{key:"handleChange",value:function(e){this.input=e}}]),n}(C),j=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e,E.Output)).output="",a.input="",a.config={},a.ConfigUi=function(){return r.a.createElement(r.a.Fragment,null)},a}return Object(p.a)(n,[{key:"run",value:function(e){return this.input=e,this.output=this.input,this.output}},{key:"handleChange",value:function(e){this.output=e}}]),n}(C),k=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(d.a)(this,n),(o=t.call(this,e,E.HtmlCodec)).output="",o.input="",o.config={isLoop:!1,ende:a.Decode},o}return Object(p.a)(n,[{key:"run",value:function(e){if(!e)return"";this.input=e;var t="";if(this.config.ende===a.Decode){var n=document.createElement("div");n.innerHTML=e,t=n.innerText||n.textContent||""}else{var o=document.createElement("div");o.appendChild(document.createTextNode(e)),t=o.innerHTML}return this.output=t,t}},{key:"handleChange",value:function(e){var t={};"boolean"===typeof e&&(t.isLoop=e),"string"===typeof e&&(t.ende=e),this.config=Object(l.a)(Object(l.a)({},this.config),t)}}]),n}(C),w=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(d.a)(this,n),(o=t.call(this,e,E.UrlComponentCodec)).output="",o.input="",o.config={isLoop:!1,ende:a.Decode},o}return Object(p.a)(n,[{key:"run",value:function(e){if(!e)return"";this.input=e;var t="";if(this.config.ende===a.Decode)if(this.config.isLoop){var n;this.output=this.input;do{n=this.output,this.output=decodeURIComponent(n)}while(this.output===n);t=this.output}else t=decodeURIComponent(this.input);else t=encodeURIComponent(this.input);return this.output=t,t}},{key:"handleChange",value:function(e){var t={};"boolean"===typeof e&&(t.isLoop=e),"string"===typeof e&&(t.ende=e),this.config=Object(l.a)(Object(l.a)({},this.config),t)}}]),n}(C);!function(e){e.HtmlCodec="HtmlCodec",e.JsonCodec="JsonCodec",e.UrlComponentCodec="UrlComponentCodec",e.UrlCodec="UrlCodec",e.Input="Input",e.Output="Output"}(E||(E={}));var I=new Map;I.set(E.JsonCodec,y),I.set(E.Input,N),I.set(E.Output,j),I.set(E.HtmlCodec,k),I.set(E.UrlComponentCodec,w);var J=n(14);function S(){return Object(J.a)()}var D=function(e){var t=e.type,n=e.id,a=e.onClick,o=e.index,i=e.shouldClone,c=e.isActive,u=function(e){return e===E.Output||e===E.Input}(t);return r.a.createElement(s.b,{draggableId:n,index:o,isDragDisabled:u},(function(e,o){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",Object.assign({ref:e.innerRef,className:"Node"+(c?" Node--active":""),"data-id":n,onClick:a},e.draggableProps,e.dragHandleProps,{style:Object(l.a)(Object(l.a)({},e.draggableProps.style),(u=o.isDragging,u?{border:"1px dashed #3cc520",backgroundColor:"hsl(110, 72%, 98%)"}:{borderStyle:"solid"}))}),t),i&&o.isDragging&&r.a.createElement("div",{className:"Node Node--copied"},t));var u}))},U=(E.UrlComponentCodec,E.JsonCodec,E.HtmlCodec,[E.UrlComponentCodec,E.HtmlCodec,E.JsonCodec]);var x,L=function(){return r.a.createElement(s.c,{droppableId:"drop-nodelib",isDropDisabled:!0},(function(e,t){return r.a.createElement("div",Object.assign({className:"NodeLib"},e.droppableProps,{ref:e.innerRef}),U.map((function(e,t){return r.a.createElement(D,{key:e,shouldClone:!0,id:"LIB-"+t,type:e,index:t})})),e.placeholder)}))};!function(e){e.NotRun="not-run",e.Error="error",e.Success="success"}(x||(x={}));var H=function(e){var t=e.onNodeFocus,n=e.workflow,a=e.refreshWorkflow,o=e.focusedNode,i=function(){for(var e="",t=0;t<n.length;t++){var o=n[t];try{e=o.run(e)}catch(r){o.output=r.message;break}}a()},c=function(e){var a=e.target,o=n.find((function(e){return e.id===a.getAttribute("data-id")}));t(o)};return r.a.createElement(s.c,{droppableId:"drop-workflow"},(function(e,t){return r.a.createElement("div",Object.assign({className:"Workflow"},e.droppableProps,{style:{border:t.isDraggingOver?"1px dashed":""},ref:e.innerRef}),r.a.createElement("div",{className:"Workflow--Guideline"}),r.a.createElement("div",{className:"Workflow--Body"},r.a.createElement("div",null,r.a.createElement("button",{onClick:i},"start")),r.a.createElement("div",{className:"Workflow--NodeList"},n.map((function(e,t){return r.a.createElement(D,Object.assign({index:t,key:e.id},e,{isActive:o&&o.id===e.id,onClick:c}))})))))}))};var F=function(e){var t=e.node,n=(e.onChange,Object(o.useState)(0)),a=Object(u.a)(n,2),i=(a[0],a[1]),c=function(){i(Math.random())};if(!t)return null;var l=t.ConfigUi;return r.a.createElement("div",{className:"State"},t.type!==E.Input&&t.type!==E.Output?r.a.createElement("div",{className:"NodeState"},r.a.createElement(l,{node:t,refresh:c})):null,t.type===E.Input&&r.a.createElement("div",{className:"NodeInput"},r.a.createElement("h2",null,"Input"),r.a.createElement("textarea",{"data-type":"input",value:t.input,onChange:function(e){t.handleChange(e.target.value),c()}})),t.type!==E.Input&&r.a.createElement("div",{className:"NodeOutput"},r.a.createElement("h2",null,"Output"),r.a.createElement("textarea",{"data-type":"output",readOnly:!0,value:t.output,onChange:function(e){return t.output=e.target.value}})))};var P=function(){return r.a.createElement("header",{className:"Head"},"flow-codec")},R=I.get(E.Input),A=I.get(E.Output),W=[new R,new A];var M=function(){var e=Object(o.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(o.useState)(W),c=Object(u.a)(i,2),l=c[0],d=c[1];return r.a.createElement("div",{className:"App"},r.a.createElement(P,null),r.a.createElement("main",{className:"Body"},r.a.createElement(s.a,{onDragEnd:function(e){if(e.destination&&"drop-workflow"===e.destination.droppableId)if("drop-nodelib"===e.source.droppableId){var t=U[e.source.index],n=I.get(t);if(n){var a=new n,o=Array.from(l);o.splice(-1,0,a),d(o)}}else{var r=Array.from(l),i=r.splice(e.source.index,1),c=Object(u.a)(i,1)[0];r.splice(e.destination.index,0,c),d(r)}}},r.a.createElement(L,null),r.a.createElement(H,{focusedNode:n,onNodeFocus:function(e){a(e)},workflow:l,refreshWorkflow:function(){return d(l.map((function(e){return e})))}})),r.a.createElement(F,{node:n,onChange:function(e){a(e)}})))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.0f27a3e0.chunk.js.map