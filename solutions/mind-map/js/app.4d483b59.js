(function(e){function t(t){for(var o,a,s=t[0],l=t[1],c=t[2],h=0,u=[];h<s.length;h++)a=s[h],i[a]&&u.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);d&&d(t);while(u.length)u.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={app:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"323a":function(e,t,n){"use strict";var o=n("e484"),i=n.n(o);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.fw?n("MindMap",{attrs:{fontWidth:e.fw}}):e._e(),n("div",{staticClass:"font-measure"},[n("span",{ref:"fontCapital"},[e._v("X")]),n("span",{ref:"font"},[e._v("x")]),n("span",{ref:"fontChinese"},[e._v("è„‘")])])],1)},r=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("svg",{ref:"svg",attrs:{width:"100%",height:"100%"},on:{click:function(t){return t.stopPropagation(),e.handleSvgClick(t)},dblclick:e.handleScaleTree,mousedown:e.handleSvgMouseDown}},[n("defs",[n("g",{attrs:{id:"collapse"}},[n("rect",{staticStyle:{stroke:"var(--baseColor)"},attrs:{x:"0",y:"0",rx:"4",ry:"4",width:"20",height:"8","stroke-width":"1"}}),n("path",{attrs:{"stroke-dasharray":"0,6",d:"M4 4 h13","stroke-width":"4",fill:"none","stroke-linecap":"round"}})]),n("g",{attrs:{id:"add"}},[n("rect",{attrs:{x:"0",y:"0",rx:"2",ry:"2",width:"16",height:"16"}}),n("path",{attrs:{d:"M 3,8 h 10 M 8,3 v 10","stroke-width":"2"}})]),n("linearGradient",{attrs:{id:"nodeActiveTextBg"}},[n("stop",{staticStyle:{"stop-color":"var(--activeTextBg)"},attrs:{offset:"80%"}}),n("stop",{attrs:{offset:"20%","stop-color":"rgba(0,0,0,0)"}})],1),n("rect",{staticStyle:{fill:"var(--pannelBg)",stroke:"var(--warnColor)"},attrs:{id:"note",x:"0",y:"0",width:"8",rx:"4",ry:"4",height:"8","stroke-width":"1"}})],1),e.tree?n("MindNode",{ref:"tree",staticClass:"tree-wraper",class:{"no-transition":e.treeNoTransition},style:"transform:translate("+e.shiftX+"px, "+e.shiftY+"px) scale("+e.scale+")",attrs:{x:"0",y:"0",node:e.tree}}):e._e()],1),e.selectedNode?n("NotePanel",{attrs:{node:e.selectedNode}}):e._e(),n("Menu",{on:{zoomBy:e.handleZoomBy,createTree:e.handleCreateTree}})],1)},s=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{staticClass:"node",attrs:{tabindex:"0"},on:{click:function(t){return t.stopPropagation(),e.handleNodeActive(t)},dblclick:function(t){return t.stopPropagation(),e.handleEditName(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:(t.stopPropagation(),e.handleRemoveNode(t))}}},[e.pNode?n("path",{attrs:{d:e.link}}):e._e(),n("path",{attrs:{d:e.path}}),n("text",{staticClass:"name",attrs:{x:e.node.x,y:e.node.y-5}},[e._v(e._s(e.node.name))]),e.hasChild()&&e.node.isCollapse?n("use",{staticClass:"collapse",attrs:{x:e.node.x+e.node.w,y:e.node.y,"xlink:href":"#collapse"},on:{click:function(t){return t.stopPropagation(),e.handleToggleChildren(t)}}}):e._e(),e.node.note?n("use",{attrs:{x:e.node.x+e.node.w-20,y:e.node.y-15,"xlink:href":"#note"}}):e._e(),n("g",{staticClass:"content",on:{mouseover:e.handleNodeMouseOver,mouseout:e.handleNodeMouseOut}},[n("rect",{staticClass:"fake-node-placeholder",attrs:{x:e.node.x,y:e.node.y-30,width:e.node.w+e.addWidth+e.addShift,height:"30"}}),n("use",{staticClass:"add",attrs:{x:e.node.x+e.node.w+e.addShift,y:e.node.y-e.addWidth,"xlink:href":"#add"},on:{click:function(t){return t.stopPropagation(),e.handleAddNode(t)}}})]),n("transition",{attrs:{name:"bloom"}},[e.hasChild()&&!e.node.isCollapse?n("g",e._l(e.node.children,function(t,o){return n("MindNode",{key:e.node.y+"_"+t.y+"_"+o,attrs:{pNode:e.node,node:t}})}),1):e._e()])],1)},c=[],d=n("5d73"),h=n.n(d);n("7f7f");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.nodeHeight,o=void 0===n?30:n,i=t.nodeGap,r=void 0===i?100:i,a=t.fontWidth,s=void 0===a?{normal:8,capital:10,chinese:12}:a,l=t.paddingLeft,c=void 0===l?20:l,d=t.paddingRight,u=void 0===d?10:d;function p(e){if(e.w=u+v(e.name,s)+c,f(e)){var t=!0,n=!1,o=void 0;try{for(var i,a=h()(e.children);!(t=(i=a.next()).done);t=!0){var l=i.value;l.x=e.x+e.w+r,p(l)}}catch(d){n=!0,o=d}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}}else e.children=[]}e.x=0;var m=0;function g(e){if(f(e)){var t=!0,n=!1,i=void 0;try{for(var r,a=h()(e.children);!(t=(r=a.next()).done);t=!0){var s=r.value;g(s)}}catch(c){n=!0,i=c}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}var l=e.children.length;e.y=(e.children[0].y+e.children[l-1].y)/2}else e.y=m*o,m++}return p(e),g(e),e}function f(e){return e&&e.children&&e.children.length}function v(e,t){for(var n=0,o=0;o<e.length;o++)/[a-z\d`~!@#$%^&*()-_=+\|\\}\][{'":;\/?.>,< ]/.test(e[o])?n+=t.normal:/[A-Z]/.test(e[o])?n+=t.capital:n+=t.chinese;return n||100}function p(){var e=!0,t=!1,n=void 0;try{for(var o,i=h()(document.querySelectorAll("svg .content"));!(e=(o=i.next()).done);e=!0){var r=o.value;r.classList.remove("active")}}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}var m={TREE_REFRESH:"tree:refresh",NODE_SELECTED:"node:selected",TREE_EMPTY:"tree:empty",TREE_LOCATE:"tree:locate"},g={name:"MindNode",props:{node:{type:Object},pNode:{type:Object}},computed:{path:function(){var e=this.node,t=e.x,n=e.y,o=e.w;return"M".concat(t," ").concat(n," h ").concat(o," v 0")},link:function(){var e=this.node,t=e.x,n=e.y,o=this.pNode,i=o.x,r=o.y,a=o.w,s=i+a;return"M".concat(s," ").concat(r,"\n              C").concat((s+t)/2," ").concat(r,", ").concat((s+t)/2," ").concat(n,",\n              ").concat(t," ").concat(n)}},data:function(){return{addShift:4,addWidth:16}},methods:{hasChild:function(){return this.node&&this.node.children.length},handleToggleChildren:function(){window.getSelection().removeAllRanges(),this.$set(this.node,"isCollapse",!this.node.isCollapse)},handleEditName:function(e){this.$set(this.node,"isCollapse",!this.node.isCollapse)},handleNodeActive:function(){p(),this.$el.querySelector(".content").classList.add("active"),this._trigger(m.NODE_SELECTED,this.node)},handleNodeMouseOver:function(){this.$el.querySelector(".add").classList.add("show")},handleNodeMouseOut:function(){this.$el.querySelector(".add").classList.remove("show")},handleAddNode:function(){this.node.children||(this.node.children=[]),this.node.children.push({name:"",children:[]}),this._trigger(m.TREE_REFRESH)},handleRemoveNode:function(){var e=this.$parent.node;if(e){for(var t=0;t<e.children.length;t++)if(e.children[t]===this.node){e.children.splice(t,1);break}this.$bus.$emit(m.TREE_REFRESH)}else this._trigger(m.TREE_EMPTY)},_trigger:function(e,t){this.$bus.$emit(e,t)}},created:function(){}},y=g,b=(n("323a"),n("2877")),w=Object(b["a"])(y,l,c,!1,null,"0ff6d69a",null),E=w.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note-pannel-wraper"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.node.name,expression:"node.name"}],staticClass:"name",attrs:{type:"textarea"},domProps:{value:e.node.name},on:{input:[function(t){t.target.composing||e.$set(e.node,"name",t.target.value)},e.handleNameChange]}}),n("div",{staticClass:"line-gap"}),n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab",class:{active:"preview"===e.activeTabName},on:{click:e.handlePreview}},[e._v("Preview")]),n("div",{staticClass:"tab",class:{active:"edit"===e.activeTabName},on:{click:e.handleEdit}},[e._v("Edit")])]),n("div",{staticClass:"content-wraper"},[e.isPreview?n("div",{domProps:{innerHTML:e._s(e.content)}}):n("div",{staticClass:"editor"},[n("div",{staticClass:"line"}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.node.note,expression:"node.note"}],staticClass:"content",domProps:{value:e.node.note},on:{input:function(t){t.target.composing||e.$set(e.node,"note",t.target.value)}}})])])])},_=[],x=n("0e54"),C=n.n(x),N={props:{node:{type:Object}},computed:{content:function(){return C()(this.node.note||"")},isPreview:function(){return"preview"===this.activeTabName}},data:function(){return{name:"",activeTabName:"preview"}},methods:{handleEdit:function(){this.activeTabName="edit"},handlePreview:function(){this.activeTabName="preview"},handleNameChange:function(){this.$bus.$emit(m.TREE_REFRESH)}}},k=N,$=(n("d1ba"),Object(b["a"])(k,T,_,!1,null,"438b489d",null)),M=$.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-wrap"},[n("button",{staticClass:"menu theme",attrs:{title:"night/day theme"},on:{click:e.handleTheme}}),n("button",{staticClass:"menu zoom-in",attrs:{title:"zoom in"},on:{click:function(t){return e.handleZoom(e.scaleInterval)}}}),n("button",{staticClass:"menu zoom-out",attrs:{title:"zoom out"},on:{click:function(t){return e.handleZoom(-e.scaleInterval)}}}),n("button",{staticClass:"menu auto",attrs:{title:"auto fit"},on:{click:e.handleAuto}}),n("label",{staticClass:"menu import",attrs:{tabindex:"-1",title:"import from markdown file",for:"invisibleFileReader"}}),n("input",{staticClass:"menu",attrs:{id:"invisibleFileReader",type:"file"},on:{change:e.handleReadFile}})])},P=[],S=(n("ac6a"),n("6c7b"),n("768b")),O=(n("28a5"),n("d225")),j=(n("b0b4"),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(O["a"])(this,e),this.name=t,this.note=n});function A(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=e.split(/\r?\n/),o=new j,i=!1,r=o,a=0,s=0;s<n.length;s++){var l=n[s];if(/^()$/.test(l))i=!1;else if(i)r.note+=l.slice(a*t+1)+"\n";else{var c=/([ ]{0,})([#-]{1,}) +(.*)/.exec(l);if(c){i=!0;var d=Object(S["a"])(c,4),h=d[1],u=d[2],f=d[3];switch(u){case"#":r.name=f,r.depth=0,a=0;break;case"##":r=W(f,1,r),a=0;break;case"###":r=W(f,2,r),a=0;break;case"-":a=h.length/t|0,r=W(f,a+3,r)}}else console.warn("get an invalid format line: ",l)}}return o}function L(e,t){return t.reduce(function(e,t){return e[t]},e)}function W(e,t,n){var o=new j(e);o.depth=t;var i=t-n.depth,r=n;if(1!==i){var a=new Array(Math.abs(i)+1).fill("parent");r=L(n,a)}return o.parent=r,r.children||(r.children=[]),r.children.push(o),o}var B={},F={data:function(){return{scaleInterval:.2,isNight:!1}},mounted:function(){var e=getComputedStyle(document.documentElement);["night","light"].forEach(function(t){B[t]={bg:e.getPropertyValue("--".concat(t,"Bg")),text:e.getPropertyValue("--".concat(t,"Text")),note:e.getPropertyValue("--".concat(t,"Note"))}})},methods:{handleZoom:function(e){this.$emit("zoomBy",e)},handleAuto:function(){this.$bus.$emit(m.TREE_LOCATE)},handleTheme:function(){this.isNight=!this.isNight;var e=B[this.isNight?"night":"light"];document.documentElement.style.setProperty("--bgColor",e.bg),document.documentElement.style.setProperty("--textColor",e.text),document.documentElement.style.setProperty("--NoteBg",e.note)},handleReadFile:function(e){var t=this,n=e.target.files[0],o=new FileReader;o.readAsText(n),o.onload=function(){var e=A(o.result);t.$emit("createTree",e)},o.onerror=function(){console.log(o.error)}}}},z=F,D=(n("a92d"),Object(b["a"])(z,R,P,!1,null,"50395d16",null)),Y=D.exports,X=.1,H={components:{MindNode:E,NotePanel:M,Menu:Y},props:{fontWidth:{type:Object}},data:function(){return{tree:{},selectedNode:null,scale:1,shiftX:0,shiftY:0,treeEl:null,svgEl:null,preMousePos:{x:0,y:0},treeNoTransition:!1}},methods:{handleSelectNode:function(e){this.selectedNode=e},handleSvgClick:function(){p(),this.selectedNode=null},handleEmptyTree:function(){this.tree=null,this.selectedNode=null},handleScaleTree:function(){this.scale*=1.5},_onMouseMove:function(e){this.shiftX+=e.clientX-this.preMousePos.x,this.shiftY+=e.clientY-this.preMousePos.y,this.preMousePos={x:e.clientX,y:e.clientY}},handleSvgMouseDown:function(e){var t=this;this._beforeTransform(),this.preMousePos={x:e.clientX,y:e.clientY},document.addEventListener("mousemove",this._onMouseMove),this.svgEl.onmouseup=function(){t._afterTransform(),document.removeEventListener("mousemove",t._onMouseMove),t.svgEl.onmouseup=null}},handleReadFile:function(e){var t=this,n=e.target.files[0],o=new FileReader;o.readAsText(n),o.onload=function(){t.tree=u(md2json(o.result),{fontWidth:t.fontWidth}),t.$nextTick(t._centerTree)},o.onerror=function(){console.log(o.error)}},_centerTree:function(){var e=this.treeEl.getBoundingClientRect(),t=this.svgEl.getBoundingClientRect();if(e.width>t.width||e.height>t.height)Math.min(t.width/e.width,t.height/e.height);this.shiftX=(t.width-e.width)/2,this.shiftY=(t.height-e.height)/2},_beforeTransform:function(){this.treeNoTransition=!0},_afterTransform:function(){this.treeNoTransition=!1},handleZoomBy:function(e){this._zoom(this.scale+e)},_zoom:function(e){this.scale=e>X?e:X},handleCreateTree:function(e){this.tree=u(e,{fontWidth:this.fontWidth}),this.$nextTick(this._centerTree)}},created:function(){var e=this;this.$bus.$on(m.NODE_SELECTED,this.handleSelectNode),this.$bus.$on(m.TREE_EMPTY,this.handleEmptyTree),this.$bus.$on(m.TREE_REFRESH,function(){e.tree=u(e.tree,{fontWidth:e.fontWidth})}),this.$bus.$on(m.TREE_LOCATE,this._centerTree),console.log({fontWidth:this.fontWidth}),this.tree=u({name:"Top level",note:"```js\n  const name = 'jonge'\n```",children:[{name:"Top 2 level -1"},{name:"Top 2 level -2",children:[{name:"Top 3 level -1",note:"## note\n> interesting"},{name:"Top 3 level -2"}]},{name:"Top 2 level -3"}]},{fontWidth:this.fontWidth})},mounted:function(){var e=this,t=this;this.treeEl=this.$refs.tree.$el,this.svgEl=this.$refs.svg,this._centerTree(),window.addEventListener("resize",function(){t._centerTree()}),window.addEventListener("wheel",function(t){t.ctrlKey&&(t.preventDefault(),e._beforeTransform(),e._zoom(.008*-t.deltaY),e.$nextTick(function(){e._afterTransform()}))},{passive:!1})}},Z=H,q=(n("9dac"),Object(b["a"])(Z,a,s,!1,null,"0ef2a863",null)),I=q.exports,V={name:"app",components:{MindMap:I},data:function(){return{fw:null}},mounted:function(){var e=this.$refs.font.getBoundingClientRect(),t=this.$refs.fontCapital.getBoundingClientRect(),n=this.$refs.fontChinese.getBoundingClientRect();this.fw={normal:e.right-e.left,capital:t.right-t.left,chinese:n.right-n.left},console.log(this.fw)}},G=V,J=(n("5c0b"),Object(b["a"])(G,i,r,!1,null,null,null)),K=J.exports;o["a"].config.productionTip=!1,o["a"].prototype.$bus=new o["a"],new o["a"]({render:function(e){return e(K)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var o=n("5e27"),i=n.n(o);i.a},"5e27":function(e,t,n){},"633b":function(e,t,n){},"95c8":function(e,t,n){},"9dac":function(e,t,n){"use strict";var o=n("633b"),i=n.n(o);i.a},a92d:function(e,t,n){"use strict";var o=n("e370"),i=n.n(o);i.a},d1ba:function(e,t,n){"use strict";var o=n("95c8"),i=n.n(o);i.a},e370:function(e,t,n){},e484:function(e,t,n){}});
//# sourceMappingURL=app.4d483b59.js.map